!function(t,e){if("function"==typeof define&&define.amd)define(["exports","jquery"],e);else if("undefined"!=typeof exports)e(exports,require("jquery"));else{var i={exports:{}};e(i.exports,t.jQuery),t.jqueryPorthole=i.exports}}(this,function(t,e){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function t(t,e){var i=[],n=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(u){o=!0,r=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(e),a=function(){function t(e,i){n(this,t),this.options=i,this._viewport=e,this._initialized=!1,this.init()}return r(t,[{key:"getCurrentPos",value:function(){return this._posGet()}},{key:"getStatus",value:function(){return{initialized:this._initialized}}},{key:"init",value:function(){this._initialized===!1&&(this._initialized=!0,this._render(),this._posInit(),this._eventsBind())}},{key:"destroy",value:function(){this._initialized===!0&&(this._initialized=!1,this._eventsUnbind(),this._renderBack())}},{key:"update",value:function(){this.destroy(),this.init()}},{key:"_render",value:function(){void 0==this._container&&(this._$viewport=s["default"](this._viewport),this._container=this._$viewport.attr("id")+"-jquery-porthole-wrapper",this._$container=s["default"]('<div id="'+this._container+'" style="display: inline-block;">'+this._$viewport.html()+"</div>"),this._viewportOverflow=this._$viewport.css("overflow"),this._$viewport.css("overflow","hidden").html(this._$container))}},{key:"_renderBack",value:function(){void 0!=this._container&&(this._$viewport.html(this._$container.html()).css("overflow",this._viewportOverflow),this._container=null,this._$container=null,this._viewportOverflow=null)}},{key:"_posInit",value:function(){this._posMax={left:this._$viewport.width()-this._$container.width(),top:this._$viewport.height()-this._$container.height()},this._posLast={left:-this.options.posStart[0],top:-this.options.posStart[1]},this._posSet(this._posLast)}},{key:"_posGet",value:function(){var t=this,e=function(){var e=[],i=!0,n=!1,o=void 0;try{for(var r,s=t._$container.css("transform").split(", ").slice(-2)[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;e.push(parseInt(a))}}catch(u){n=!0,o=u}finally{try{!i&&s["return"]&&s["return"]()}finally{if(n)throw o}}return e}(),i=o(e,2),n=i[0],r=i[1];return{left:n,top:r}}},{key:"_posSet",value:function(t){var e=t.left,i=t.top,n=this._posMax,o=n.left,r=n.top;e=e>0?0:e,i=i>0?0:i,e=o>e?o:e,i=r>i?r:i,this._$container.css("transform","translate3d("+e+"px, "+i+"px, 0px)")}},{key:"_getPointerXY",value:function(t){var e=t.pageX||t.originalEvent.touches[0].pageX,i=t.pageY||t.originalEvent.touches[0].pageY;return[e,i]}},{key:"_eventMousedown",value:function(t){var e=this;this._dragging=!0;var i=this._getPointerXY(t),n=o(i,2),r=n[0],a=n[1];s["default"](document).on(this._dragEventName,function(t){var i=e._getPointerXY(t),n=o(i,2),s=n[0],u=n[1];e._posSet({left:s-r+e._posLast.left,top:u-a+e._posLast.top}),"undefined"!=typeof e.options.onDrag&&e.options.onDrag(e)}),"undefined"!=typeof this.options.onDragStart&&this.options.onDragStart(this)}},{key:"_eventMouseup",value:function(){this._dragging===!0&&(this._dragging=!1,this._posLast=this._posGet(),s["default"](document).off(this._dragEventName),"undefined"!=typeof this.options.onDragStop&&this.options.onDragStop(this))}},{key:"_eventsBind",value:function(){var t=this;this._dragStartEventName="touchstart."+this._container+" mousedown."+this._container,this._dragStopEventName="touchend."+this._container+" mouseup."+this._container,this._dragEventName="touchmove."+this._container+" mousemove."+this._container,this._$container.on(this._dragStartEventName,function(e){t._eventMousedown(e)}),s["default"](document).on(this._dragStopEventName,function(){t._eventMouseup()})}},{key:"_eventsUnbind",value:function(){var t="."+this._container;this._$container.off(t),s["default"](document).off(t)}}]),t}();t.Porthole=a,s["default"].fn.porthole=function(t){return t=s["default"].extend({posStart:[0,0],onDrag:void 0,onDragStart:void 0,onDragStop:void 0},t),new a(this,t)}});